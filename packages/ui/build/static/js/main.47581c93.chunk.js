(this["webpackJsonp@pokt-foundation/node-monitoring-ui"]=this["webpackJsonp@pokt-foundation/node-monitoring-ui"]||[]).push([[0],{202:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(73),i=n.n(c),o=n(102),s=n(260),l=n(22),d=n(13),j=n(172),u=n(263),b=new j.a({uri:"http://localhost:4000",cache:new u.a({addTypename:!0,typePolicies:{Query:{fields:{logs:{keyArgs:!1,merge:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{docs:[],hasNextPage:!1,hasPrevPage:!1,limit:0,page:0,totalDocs:0,totalPages:0,pagingCounter:0},t=arguments.length>1?arguments[1]:void 0;return Object(d.a)(Object(d.a)({},t),{},{docs:[].concat(Object(l.a)(e.docs),Object(l.a)(t.docs)).sort((function(e,t){return new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime()}))})}}}}}})}),O=n(10),h=n(4),x=n(6),f=n(167),m=n(274),p=n(259),g=n(273),v=n(279),y=n(281),C=n(280),S=n(115),w=n(278),k=n(282),P=n(165),$=n.n(P),D=n(166),H=n.n(D),N=n(32),B=n(0);function I(e){return Object(B.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:"HOME"})}function L(e){return Object(B.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:"SETTINGS"})}var F=n(287),M=n(271),T=n(262),E=n(275),A=n(299),R=n(269),W=n(256);n(284);var q=n(289),_=n(290),z=n(291),V=n(276),U=n(277),G=n(292),J=n(285),Z=n(293),K=n(294),Q=n(295),X=n(296),Y=n(153),ee=n.n(Y),te=n(152),ne=n.n(te),ae=["aws","id","ip","ssl","url"],re=function(e){return(e[0].toUpperCase()+e.slice(1)).replace(/([A-Z])/g," $1").trim().split(" ").map((function(e){return ae.includes(e.toLowerCase())?e.toUpperCase():e})).join(" ")},ce=n(288),ie=n(150),oe=n.n(ie),se=n(151),le=n.n(se);function de(e){var t=e.value,n=e.handleChange,a=e.type,r=e.sx,c="Search".concat(a?" ".concat(a):"");return Object(B.jsxs)(F.a,{fullWidth:!0,sx:r,children:[Object(B.jsx)(M.a,{htmlFor:"search-input",children:c}),Object(B.jsx)(E.a,{id:"search-input",value:t,onChange:function(e){var t=e.target;return n(t.value)},startAdornment:Object(B.jsx)(ce.a,{position:"start",children:Object(B.jsx)(oe.a,{})}),endAdornment:t&&Object(B.jsx)(le.a,{sx:{cursor:"pointer"},onClick:function(){return n("")}}),label:c})]})}function je(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function ue(e,t){return"desc"===e?function(e,n){return je(e,n,t)}:function(e,n){return-je(e,n,t)}}function be(e){var t=e.rows,n=e.order,a=e.orderBy,r=e.onRequestSort,c=t.length?Object.keys(t[0]).filter((function(e){return"id"!==e&&"__typename"!==e&&"health"!==e})).map((function(e){return{id:e,label:re(e)}})):[];return Object(B.jsx)(q.a,{children:Object(B.jsxs)(_.a,{children:[Object(B.jsx)(z.a,{}),Object(B.jsx)(z.a,{}),c.map((function(e,t){return Object(B.jsx)(z.a,{align:t?"right":"left",sortDirection:a===e.id&&n,children:Object(B.jsx)(V.a,{active:a===e.id,direction:a===e.id?n:"asc",onClick:(c=e.id,function(e){r(e,c)}),children:e.label})},e.id);var c}))]})})}function Oe(e){var t=e.rows,n=e.loading,r=e.loadItems,c=e.height,i=e.searchable,o=e.selectedRow,s=e.type,l=e.onSelectRow,j=Object(a.useState)("asc"),u=Object(O.a)(j,2),b=u[0],h=u[1],x=Object(a.useState)(""),f=Object(O.a)(x,2),m=f[0],p=f[1],g=Object(a.useState)(""),y=Object(O.a)(g,2),C=y[0],k=y[1],P=t.map((function(e){var t=e.message,n=e.timestamp,a=JSON.parse(t);return Object(d.a)({timestamp:new Date(Number(n)).toISOString()},a)})),$=Object(a.useRef)(),D=Object(a.useState)(0),H=Object(O.a)(D,2),N=H[0],I=H[1],L=Object(a.useState)(!0),F=Object(O.a)(L,1)[0],M=Object(a.useCallback)((function(){r()}),[t]),T=Object(a.useCallback)((function(){var e=$.current.scrollHeight-$.current.clientHeight;N||I(Math.round(e/100*20)),!n&&$.current.scrollTop>e-N&&F&&M()}),[F,M,n,N]);Object(a.useLayoutEffect)((function(){var e=$.current;return e.addEventListener("scroll",T),function(){e.removeEventListener("scroll",T)}}),[T]);var E=function(e){var t=e.row,n=e.index,r=Object(a.useState)(!1),c=Object(O.a)(r,2),i=c[0],s=c[1];return Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(_.a,{sx:{"&:last-child td, &:last-child th":{border:0},cursor:"".concat(l?"pointer":"default")},hover:!!l,selected:o===String(t.timestamp),children:[Object(B.jsx)(z.a,{sx:{width:16},children:Object(B.jsx)(U.a,{sx:{width:"100%"},color:{OK:"success",ERROR:"error"}[t.status]||"default"})}),Object(B.jsx)(z.a,{children:Object(B.jsx)(w.a,{"aria-label":"expand row",size:"small",onClick:function(){return s(!i)},children:i?Object(B.jsx)(ne.a,{}):Object(B.jsx)(ee.a,{})})}),Object.entries(t).filter((function(e){var t=Object(O.a)(e,1)[0];return"id"!==t&&"__typename"!==t&&"health"!==t})).map((function(e,n){var a=Object(O.a)(e,2),r=(a[0],a[1]);return Object(B.jsx)(z.a,{align:n?"right":"left",onClick:function(){return null===l||void 0===l?void 0:l(t)},children:Array.isArray(r)?r.join(", "):String(r)},"".concat(r,"-").concat(n))}))]},"".concat(t.timestamp,"-").concat(n)),Object(B.jsx)(_.a,{children:Object(B.jsx)(z.a,{style:{paddingBottom:0,paddingTop:0},colSpan:6,children:Object(B.jsx)(G.a,{in:i,timeout:"auto",unmountOnExit:!0,children:Object(B.jsx)(v.a,{sx:{margin:1},children:Object(B.jsx)(S.a,{variant:"h6",gutterBottom:!0,component:"div",children:Object(B.jsx)("div",{children:Object(B.jsx)("pre",{children:JSON.stringify(t.health,null,2)})})})})})})})]})};return Object(B.jsx)(v.a,{sx:{width:"100%"},children:Object(B.jsxs)(J.a,{sx:{width:"100%",overflow:"hidden",padding:"16px"},children:[s&&Object(B.jsx)(S.a,{align:"center",variant:"h4",gutterBottom:!0,children:s}),i&&Object(B.jsx)(de,{value:C,handleChange:k,type:s,sx:{marginBottom:"16px"}}),Object(B.jsxs)(Z.a,{sx:{maxHeight:c||600},ref:$,children:[Object(B.jsxs)(K.a,{stickyHeader:!0,sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"small",children:[Object(B.jsx)(be,{rows:P,order:b,orderBy:m,onRequestSort:function(e,t){h(m===t&&"asc"===b?"desc":"asc"),p(t)},rowCount:t.length}),Object(B.jsx)(Q.a,{children:P.slice().filter((function(e){return!i||Object.values(e).join().toLowerCase().trim().includes(C.toLowerCase().trim())})).sort(ue(b,m)).map((function(e,t){return Object(B.jsx)(E,{row:e,index:t})}))})]}),n&&Object(B.jsx)("div",{style:{display:"flex",justifyContent:"center",overflow:"hidden",marginTop:8},children:Object(B.jsx)(X.a,{})})]})]})})}var he=n(266);function xe(e,t,n){return t[n]<e[n]?-1:t[n]>e[n]?1:0}function fe(e,t){return"desc"===e?function(e,n){return xe(e,n,t)}:function(e,n){return-xe(e,n,t)}}function me(e){var t=e.rows,n=e.order,a=e.orderBy,r=e.onRequestSort,c=t.length?Object.keys(t[0]).filter((function(e){return"id"!==e&&"__typename"!==e})).map((function(e){return{id:e,label:re(e)}})):[];return Object(B.jsx)(q.a,{children:Object(B.jsx)(_.a,{children:c.map((function(e,t){return Object(B.jsx)(z.a,{align:t?"right":"left",sortDirection:a===e.id&&n,children:Object(B.jsx)(V.a,{active:a===e.id,direction:a===e.id?n:"asc",onClick:(c=e.id,function(e){r(e,c)}),children:e.label})},e.id);var c}))})})}function pe(e){var t=e.rows,n=e.height,r=e.searchable,c=e.paginate,i=e.numPerPage,o=e.selectedRow,s=e.type,l=e.onSelectRow,d=Object(a.useState)("asc"),j=Object(O.a)(d,2),u=j[0],b=j[1],h=Object(a.useState)(""),x=Object(O.a)(h,2),f=x[0],m=x[1],p=Object(a.useState)(0),g=Object(O.a)(p,2),y=g[0],C=g[1],w=Object(a.useState)(c?i||25:t.length),k=Object(O.a)(w,2),P=k[0],$=k[1],D=Object(a.useState)(""),H=Object(O.a)(D,2),N=H[0],I=H[1],L=y>0?Math.max(0,(1+y)*P-t.length):0;return Object(B.jsx)(v.a,{sx:{width:"100%"},children:Object(B.jsxs)(J.a,{sx:{width:"100%",overflow:"hidden",padding:"16px"},children:[s&&Object(B.jsx)(S.a,{align:"center",variant:"h4",gutterBottom:!0,children:s}),r&&Object(B.jsx)(de,{value:N,handleChange:I,type:s,sx:{marginBottom:"16px"}}),Object(B.jsx)(Z.a,{sx:{maxHeight:n||600},children:Object(B.jsxs)(K.a,{stickyHeader:!0,sx:{minWidth:750},"aria-labelledby":"tableTitle",size:"small",children:[Object(B.jsx)(me,{rows:t,order:u,orderBy:f,onRequestSort:function(e,t){b(f===t&&"asc"===u?"desc":"asc"),m(t)},rowCount:t.length}),Object(B.jsxs)(Q.a,{children:[t.slice().filter((function(e){return!r||Object.values(e).join().toLowerCase().trim().includes(N.toLowerCase().trim())})).sort(fe(u,f)).slice(y*P,y*P+P).map((function(e){return Object(B.jsx)(_.a,{sx:{"&:last-child td, &:last-child th":{border:0},cursor:"".concat(l?"pointer":"default")},hover:!!l,selected:o===String(e.id),children:Object.entries(e).filter((function(e){var t=Object(O.a)(e,1)[0];return"id"!==t&&"__typename"!==t})).map((function(t,n){var a=Object(O.a)(t,2),r=(a[0],a[1]);return Object(B.jsx)(z.a,{align:n?"right":"left",onClick:function(){return null===l||void 0===l?void 0:l(e)},children:Array.isArray(r)?r.join(", "):String(r)},"".concat(r,"-").concat(n))}))},String(e.id))})),L>0&&Object(B.jsx)(_.a,{style:{height:33*L},children:Object(B.jsx)(z.a,{colSpan:6})})]})]})}),c&&Object(B.jsx)(he.a,{rowsPerPageOptions:[5,10,25],component:"div",count:t.length,rowsPerPage:P,page:y,onPageChange:function(e,t){C(t)},onRowsPerPageChange:function(e){$(parseInt(e.target.value,10)),C(0)}})]})})}var ge,ve,ye,Ce,Se,we,ke,Pe,$e,De,He,Ne,Be,Ie,Le,Fe,Me,Te,Ee=n(254),Ae=n(286),Re=n(268),We=n(255),qe=n(158),_e=n.n(qe),ze=n(157),Ve=n.n(ze),Ue=n(159),Ge=n.n(Ue),Je=n(132),Ze=n.n(Je),Ke=n(161),Qe=n.n(Ke),Xe=n(160),Ye=n.n(Xe),et=function(e){var t=Object(N.e)();return Object(B.jsxs)("div",{children:[Object(B.jsx)(Ee.a,{}),Object(B.jsx)(Ae.a,{children:Object(B.jsxs)("div",{children:[Object(B.jsxs)(Re.a,{button:!0,onClick:function(){return t.push("/logs")},children:[Object(B.jsx)(We.a,{children:Object(B.jsx)(Ze.a,{})}),Object(B.jsx)(W.a,{primary:"Logs"})]}),Object(B.jsxs)(Re.a,{button:!0,onClick:function(){return t.push("/nodes")},children:[Object(B.jsx)(We.a,{children:Object(B.jsx)(Ze.a,{})}),Object(B.jsx)(W.a,{primary:"Nodes"})]}),Object(B.jsxs)(Re.a,{button:!0,onClick:function(){return t.push("/hosts")},children:[Object(B.jsx)(We.a,{children:Object(B.jsx)(Ve.a,{})}),Object(B.jsx)(W.a,{primary:"Hosts"})]}),Object(B.jsxs)(Re.a,{button:!0,onClick:function(){return t.push("/chains")},children:[Object(B.jsx)(We.a,{children:Object(B.jsx)(_e.a,{})}),Object(B.jsx)(W.a,{primary:"Chains"})]}),Object(B.jsxs)(Re.a,{button:!0,onClick:function(){return t.push("/oracles")},children:[Object(B.jsx)(We.a,{children:Object(B.jsx)(Ge.a,{})}),Object(B.jsx)(W.a,{primary:"Oracles"})]}),Object(B.jsxs)(Re.a,{button:!0,onClick:function(){return t.push("/webhooks")},children:[Object(B.jsx)(We.a,{children:Object(B.jsx)(Ye.a,{})}),Object(B.jsx)(W.a,{primary:"Webhooks"})]})]})}),Object(B.jsx)(Ee.a,{}),Object(B.jsx)(Ae.a,{children:Object(B.jsx)("div",{children:Object(B.jsxs)(Re.a,{button:!0,onClick:function(){return t.push("/settings")},children:[Object(B.jsx)(We.a,{children:Object(B.jsx)(Qe.a,{})}),Object(B.jsx)(W.a,{primary:"Settings"})]})})})]})},tt=n(27),nt=n(261),at=n(257),rt=n(162),ct=n(258),it={},ot=Object(nt.a)(ge||(ge=Object(tt.a)(["\n    mutation CreateHost($location: String!, $name: String!, $loadBalancer: Boolean!, $ip: String, $fqdn: String) {\n  createHost(\n    location: $location\n    name: $name\n    ip: $ip\n    fqdn: $fqdn\n    loadBalancer: $loadBalancer\n  ) {\n    name\n    ip\n    loadBalancer\n  }\n}\n    "])));var st=Object(nt.a)(ve||(ve=Object(tt.a)(["\n    mutation CreateNode($chain: ID!, $host: ID!, $port: Int!, $url: String!, $loadBalancers: [ID!]!, $haProxy: Boolean!, $backend: String, $server: String) {\n  createNode(\n    input: {chain: $chain, host: $host, port: $port, url: $url, loadBalancers: $loadBalancers, haProxy: $haProxy, backend: $backend, server: $server}\n  ) {\n    id\n    url\n  }\n}\n    "])));var lt=Object(nt.a)(ye||(ye=Object(tt.a)(["\n    mutation CreateNodesCSV($nodes: [NodeCSVInput!]!) {\n  createNodesCSV(nodes: $nodes) {\n    id\n  }\n}\n    "])));var dt=Object(nt.a)(Ce||(Ce=Object(tt.a)(["\n    mutation RebootServer($id: ID!) {\n  rebootServer(id: $id)\n}\n    "])));var jt=Object(nt.a)(Se||(Se=Object(tt.a)(["\n    mutation EnableHaProxyServer($id: ID!) {\n  enableHaProxyServer(id: $id)\n}\n    "])));var ut=Object(nt.a)(we||(we=Object(tt.a)(["\n    mutation DisableHaProxyServer($id: ID!) {\n  disableHaProxyServer(id: $id)\n}\n    "])));var bt=Object(nt.a)(ke||(ke=Object(tt.a)(["\n    mutation MuteMonitor($id: ID!) {\n  muteMonitor(id: $id) {\n    id\n    muted\n  }\n}\n    "])));var Ot=Object(nt.a)(Pe||(Pe=Object(tt.a)(["\n    mutation UnmuteMonitor($id: ID!) {\n  unmuteMonitor(id: $id) {\n    id\n    muted\n  }\n}\n    "])));var ht=Object(nt.a)($e||($e=Object(tt.a)(["\n    query Chains {\n  chains {\n    id\n    name\n    type\n    variance\n  }\n}\n    "])));var xt=Object(nt.a)(De||(De=Object(tt.a)(["\n    query Hosts {\n  hosts {\n    id\n    name\n    ip\n    loadBalancer\n    location\n  }\n}\n    "])));var ft=Object(nt.a)(He||(He=Object(tt.a)(["\n    query Locations {\n  locations {\n    id\n    name\n  }\n}\n    "])));Object(nt.a)(Ne||(Ne=Object(tt.a)(["\n    query Node($id: ID!) {\n  node(id: $id) {\n    id\n    backend\n    port\n    server\n    url\n    ssl\n    muted\n    loadBalancers\n  }\n}\n    "])));var mt=Object(nt.a)(Be||(Be=Object(tt.a)(["\n    query Nodes {\n  nodes {\n    id\n    backend\n    port\n    server\n    url\n    ssl\n    muted\n    loadBalancers\n  }\n}\n    "])));function pt(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(mt,t)}var gt=Object(nt.a)(Ie||(Ie=Object(tt.a)(["\n    query Logs($nodeIds: [ID!]!, $page: Int!, $limit: Int!, $startDate: String, $endDate: String) {\n  logs(\n    nodeIds: $nodeIds\n    page: $page\n    limit: $limit\n    startDate: $startDate\n    endDate: $endDate\n  ) {\n    docs {\n      message\n      level\n      timestamp\n    }\n    totalDocs\n    page\n    hasPrevPage\n    hasNextPage\n  }\n}\n    "])));var vt=Object(nt.a)(Le||(Le=Object(tt.a)(["\n    query Oracles {\n  oracles {\n    id\n    chain\n    urls\n  }\n}\n    "])));var yt=Object(nt.a)(Fe||(Fe=Object(tt.a)(["\n    query Webhooks {\n  webhooks {\n    id\n    location\n    chain\n    url\n  }\n}\n    "])));var Ct=Object(nt.a)(Me||(Me=Object(tt.a)(["\n    query GetHostsChainsAndLoadBalancers {\n  hosts {\n    id\n    name\n    ip\n    location\n  }\n  chains {\n    id\n    name\n  }\n  loadBalancers: hosts(loadBalancer: true) {\n    id\n    name\n  }\n}\n    "])));var St=Object(nt.a)(Te||(Te=Object(tt.a)(["\n    query GetNodeStatus($id: ID!) {\n  haProxyStatus: getHaProxyStatus(id: $id)\n}\n    "])));var wt=n(39),kt=n(163),Pt=n.n(kt),$t=n(168);wt.e.register(wt.d,wt.h,wt.b,wt.m);var Dt={responsive:!0,maintainAspectRatio:!1};function Ht(e){e.logs;var t=e.logPeriod,n=Date.now()-(Date.now()-t.timePeriod),a=Math.floor(n/t.resolution);console.log({increments:a});var r=Object(l.a)(Array(a)).map((function(e,n,a){return Pt()(Date.now()-(a.length-n)*t.resolution).format(t.format)})),c={labels:r,datasets:[{data:r.map((function(){return 1})),backgroundColor:"rgba(255, 99, 132, 0.5)"}]};return Object(B.jsx)("div",{style:{height:"200px",width:"100%"},children:Object(B.jsx)($t.a,{options:Dt,data:c})})}var Nt=6e4,Bt=36e5,It=864e5,Lt=[{code:"15M",label:"Past 15 Minutes",timePeriod:9e5,resolution:Nt,format:"HH:mm"},{code:"1H",label:"Past 2 Hours",timePeriod:Bt,resolution:3e5,format:"HH:mm"},{code:"4H",label:"Past 4 Hours",timePeriod:144e5,resolution:9e5,format:"HH:mm"},{code:"1D",label:"Past 1 Day",timePeriod:It,resolution:Bt,format:"HH:mm"},{code:"2D",label:"Past 2 Days",timePeriod:1728e5,resolution:108e5,format:"HH:mm"},{code:"3D",label:"Past 3 Days",timePeriod:2592e5,resolution:216e5,format:"HH:mm"},{code:"7D",label:"Past 7 Days",timePeriod:6048e5,resolution:432e5,format:"HH:mm"},{code:"15D",label:"Past 15 Days",timePeriod:1296e6,resolution:It,format:"ddd MMM DD"},{code:"1MO",label:"Past 1 Month",timePeriod:2592e6,resolution:1728e5,format:"ddd, MMM DD"}];function Ft(){var e,t=Object(a.useState)([]),n=Object(O.a)(t,2),r=n[0],c=n[1],i=Object(a.useState)(Lt[0]),o=Object(O.a)(i,2),s=o[0],l=o[1],j=Object(a.useState)(!1),u=Object(O.a)(j,2),b=u[0],h=u[1],x=pt(),f=x.data,m=x.error,p=x.loading,g=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(gt,t)}({variables:{nodeIds:r,page:1,limit:100},onCompleted:function(){return h(!1)},onError:function(){return h(!1)}}),v=g.data,y=g.error,C=g.fetchMore,S=g.refetch;Object(a.useEffect)((function(){h(!0),S()}),[r]);return p?Object(B.jsx)(B.Fragment,{children:"Loading..."}):m||y?Object(B.jsxs)(B.Fragment,{children:["Error! $",null===(e=m||y)||void 0===e?void 0:e.message]}):(v&&console.log("LOGS DATA HERE!!!",{logsData:v}),Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"16px"},children:[Object(B.jsxs)(F.a,{fullWidth:!0,children:[Object(B.jsx)(M.a,{id:"lb-label",children:"Select Nodes"}),Object(B.jsx)(T.a,{multiple:!0,labelId:"lb-label",value:r,onChange:function(e){var t=e.target.value;console.log({value:t}),c("string"===typeof t?t.split(","):t)},input:Object(B.jsx)(E.a,{label:"Nodes"}),renderValue:function(e){return e.map((function(e){return null===f||void 0===f?void 0:f.nodes.find((function(t){return t.id===e})).backend})).join(", ")},children:null===f||void 0===f?void 0:f.nodes.map((function(e){var t=e.port,n=e.backend,a=e.id,c=e.server;return Object(B.jsxs)(A.a,{value:a,children:[Object(B.jsx)(R.a,{checked:r.indexOf(a)>-1}),Object(B.jsx)(W.a,{primary:"".concat(n,"/").concat(t,"/").concat(c)})]},a)}))})]}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsxs)(F.a,{fullWidth:!0,children:[Object(B.jsx)(M.a,{id:"chain-label",children:"Time Period"}),Object(B.jsx)(T.a,{labelId:"chain-label",value:s.code,label:"Time Period",onChange:function(e){var t=e.target.value;l(Lt.find((function(e){return e.code===t})))},children:Lt.map((function(e){var t=e.code,n=e.label;return Object(B.jsx)(A.a,{value:t,children:n},t)}))})]}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),v&&Object(B.jsx)(Ht,{logs:v.logs.docs,logPeriod:s}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),v&&Object(B.jsx)(Oe,{type:"Showing ".concat(v.logs.docs.length," log entries for ").concat(r.length," Nodes."),searchable:!0,rows:v.logs.docs,loading:b,loadItems:function(){v.logs.hasNextPage&&(h(!0),C({variables:{page:v.logs.docs.length/100+1}}))}})]}))}function Mt(){var e=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(ht,t)}(),t=e.data,n=e.error;return e.loading?Object(B.jsx)(B.Fragment,{children:"Loading..."}):n?Object(B.jsxs)(B.Fragment,{children:["Error! $",n.message]}):Object(B.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"16px"},children:t&&Object(B.jsx)(pe,{type:"Chains",searchable:!0,paginate:!0,rows:t.chains})})}var Tt=n(272),Et=n(300),At=n(301);function Rt(e){var t=e.refetchHosts,n=Object(a.useState)("NL"),r=Object(O.a)(n,2),c=r[0],i=r[1],o=Object(a.useState)(""),s=Object(O.a)(o,2),l=s[0],j=s[1],u=Object(a.useState)(""),b=Object(O.a)(u,2),h=b[0],x=b[1],f=Object(a.useState)(""),m=Object(O.a)(f,2),p=m[0],g=m[1],v=Object(a.useState)(!1),y=Object(O.a)(v,2),C=y[0],S=y[1],w=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(ft,t)}(),k=w.data,P=w.error,$=w.loading,D=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(ot,t)}({onCompleted:function(){return t()}}),H=Object(O.a)(D,1)[0];return $?Object(B.jsx)(B.Fragment,{children:"Loading..."}):P?Object(B.jsxs)(B.Fragment,{children:["Error! $",P.message]}):Object(B.jsx)(B.Fragment,{children:Object(B.jsx)("div",{children:Object(B.jsx)(J.a,{style:{width:"200%",padding:10},variant:"outlined",children:Object(B.jsxs)(F.a,{fullWidth:!0,children:[Object(B.jsx)(T.a,{value:c,onChange:function(e){i(e.target.value)},children:null===k||void 0===k?void 0:k.locations.map((function(e){var t=e.id,n=e.name;return Object(B.jsx)(A.a,{value:t,children:n})}))}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(Tt.a,{value:l,onChange:function(e){j(e.target.value)},label:"Host Name",variant:"outlined"}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(Tt.a,{value:h,onChange:function(e){x(e.target.value)},label:"Host IP",variant:"outlined"}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(Tt.a,{value:p,onChange:function(e){g(e.target.value)},label:"Host FQDN",variant:"outlined"}),Object(B.jsxs)("div",{children:["Load Balancer",Object(B.jsx)(Et.a,{checked:C,onChange:function(e){S(e.target.checked)}})]}),Object(B.jsx)(At.a,{fullWidth:!0,style:{display:"flex",justifyContent:"center"},variant:"outlined",onClick:function(){H({variables:{location:c,name:l,ip:h,fqdn:p,loadBalancer:C}}),i(""),j(""),x(""),g(""),S(!1)},children:"Submit"})]})})})})}function Wt(){var e=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(xt,t)}(),t=e.data,n=e.error,a=e.loading,r=e.refetch;return a?Object(B.jsx)(B.Fragment,{children:"Loading..."}):n?Object(B.jsxs)(B.Fragment,{children:["Error! $",n.message]}):Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"16px"},children:[Object(B.jsx)("div",{style:{marginBottom:"16px"},children:Object(B.jsx)(Rt,{refetchHosts:r})}),t&&Object(B.jsx)(pe,{type:"Hosts",searchable:!0,paginate:!0,rows:t.hosts})]})}var qt=n(164),_t=n.n(qt),zt=n(265),Vt=n(267),Ut=n(302),Gt={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"90%",bgcolor:"background.paper",border:"2px solid #000",boxShadow:24,p:4};function Jt(e){var t=e.formData,n=t.chains,r=t.hosts,c=t.loadBalancers,i=e.refetchNodes,o=Object(a.useState)(!1),s=Object(O.a)(o,2),l=s[0],j=s[1],u=Object(a.useState)(void 0),b=Object(O.a)(u,2),h=b[0],x=b[1],f=Object(a.useState)(""),m=Object(O.a)(f,2),p=m[0],g=m[1],y=Object(a.useState)(""),C=Object(O.a)(y,2),w=C[0],k=C[1],P=function(){return j(!1)},$=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(lt,t)}({onCompleted:function(){i(),P()}}),D=Object(O.a)($,2),H=D[0],N=D[1],I=N.error,L=N.loading;Object(a.useEffect)((function(){I&&k(function(e){var t=e.message;if(t.includes("duplicate key error collection")){var n=t.split("{")[1];return"Validation Error - Record already exists with fields: { ".concat(n)}return t}(I))}),[I]);var F=n.map((function(e){return e.name})),M=r.map((function(e){return e.name})),T=c.map((function(e){return e.name})),E={chain:function(e){return F.includes(e.toUpperCase())},host:function(e){return M.includes(e.toLowerCase())},haProxy:function(e){return"true"===e.toLowerCase()||"false"===e.toLowerCase()},loadBalancers:function(e){return e.toLowerCase().split(",").every((function(e){return T.includes(e)}))},port:function(e){return/^([1-9][0-9]{0,3}|[1-5][0-9]{4}|6[0-4][0-9]{3}|65[0-4][0-9]{2}|655[0-2][0-9]|6553[0-5])$/.test(e)},url:function(e){return/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/.test(e)}};return Object(B.jsxs)("div",{children:[Object(B.jsx)(At.a,{onClick:function(){return j(!0)},variant:"outlined",children:"Upload CSV"}),Object(B.jsx)(zt.a,{open:l,onClose:P,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:Object(B.jsxs)(v.a,{sx:Gt,children:[Object(B.jsx)(S.a,{id:"modal-modal-title",variant:"h6",component:"h2",children:"Upload Nodes CSV"}),Object(B.jsx)(_t.a,{onFileLoaded:function(e){var t=e.filter((function(e){return Object.keys(E).every((function(t){return Object.keys(e).includes(t)}))})),n=[],a=t.map((function(e){var t,a=function(e,t){return Object.keys(t).filter((function(n){return!t[n](e[n])}))}(e,E);return a.length&&n.push("[".concat(e.host,"/").concat(e.chain,"]: ").concat(a.join(", "))),Object(d.a)(Object(d.a)({},e),{},{chain:e.chain.toUpperCase(),host:e.host.toLowerCase(),port:Number(e.port),loadBalancers:null===(t=e.loadBalancers)||void 0===t?void 0:t.toLowerCase().split(","),haProxy:Boolean(e.haProxy)})}));n.length?g(n.join("\n")):x(a)},parserOptions:{header:!0}}),p&&Object(B.jsxs)(Vt.a,{severity:"error",children:[Object(B.jsx)(Ut.a,{children:"Warning: Invalid fields detected. Please correct the following fields before attempting to upload Nodes CSV."}),p]}),w&&Object(B.jsx)(Vt.a,{severity:"error",children:Object(B.jsxs)(Ut.a,{children:["Backend error: ",w]})}),h&&Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(pe,{type:"Adding ".concat(h.length," Node").concat(1===h.length?"":"s"),rows:h}),Object(B.jsx)(At.a,{style:{marginTop:8},onClick:function(){h&&H({variables:{nodes:h}})},variant:"outlined",children:L?Object(B.jsx)(X.a,{size:20}):"Add ".concat(h.length," Node").concat(1===h.length?"":"s")})]})]})})]})}function Zt(e){var t=e.formData,n=e.refetchNodes,r=Object(a.useState)(""),c=Object(O.a)(r,2),i=c[0],o=c[1],s=Object(a.useState)(""),l=Object(O.a)(s,2),j=l[0],u=l[1],b=Object(a.useState)(""),h=Object(O.a)(b,2),x=h[0],f=h[1],m=Object(a.useState)([]),p=Object(O.a)(m,2),g=p[0],v=p[1],y=Object(a.useState)(0),C=Object(O.a)(y,2),w=C[0],k=C[1],P=Object(a.useState)(""),$=Object(O.a)(P,2),D=$[0],H=$[1],N=Object(a.useState)(""),I=Object(O.a)(N,2),L=I[0],q=I[1],_=Object(a.useState)(!0),z=Object(O.a)(_,2),V=z[0],U=z[1],G=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(st,t)}({onCompleted:function(){return n()},onError:function(e){return console.log({error:e})}}),Z=Object(O.a)(G,1)[0];return Object(B.jsx)(B.Fragment,{children:Object(B.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:Object(B.jsxs)(J.a,{style:{width:"200%",padding:10},variant:"outlined",children:[Object(B.jsx)(S.a,{align:"center",variant:"h6",gutterBottom:!0,children:"Add New Node"}),Object(B.jsxs)(F.a,{fullWidth:!0,children:[Object(B.jsx)(M.a,{id:"chain-label",children:"Chain"}),Object(B.jsx)(T.a,{labelId:"chain-label",value:i,label:"Chain",onChange:function(e){o(e.target.value)},children:null===t||void 0===t?void 0:t.chains.map((function(e){var t=e.name,n=e.id;return Object(B.jsx)(A.a,{value:n,children:t},n)}))})]}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsxs)(F.a,{fullWidth:!0,children:[Object(B.jsx)(M.a,{id:"host-label",children:"Host"}),Object(B.jsx)(T.a,{labelId:"host-label",value:j,label:"Host",onChange:function(e){if(null!==t&&void 0!==t&&t.hosts){var n=t.hosts.find((function(t){return t.id===e.target.value})).ip;f(n),console.log({ip:n})}u(e.target.value)},children:null===t||void 0===t?void 0:t.hosts.map((function(e){var t=e.name,n=e.id,a=e.location;return Object(B.jsx)(A.a,{value:n,children:"".concat(t," - ").concat(a)},n)}))})]}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsxs)(F.a,{fullWidth:!0,children:[Object(B.jsx)(M.a,{id:"lb-label",children:"Load Balancers"}),Object(B.jsx)(T.a,{multiple:!0,labelId:"lb-label",value:g,onChange:function(e){var t=e.target.value;v("string"===typeof t?t.split(","):t)},input:Object(B.jsx)(E.a,{label:"Load Balancers"}),renderValue:function(e){return e.map((function(e){return null===t||void 0===t?void 0:t.loadBalancers.find((function(t){return t.id===e})).name})).join(", ")},children:null===t||void 0===t?void 0:t.loadBalancers.map((function(e){var t=e.name,n=e.id;return Object(B.jsxs)(A.a,{value:n,children:[Object(B.jsx)(R.a,{checked:g.indexOf(n)>-1}),Object(B.jsx)(W.a,{primary:t})]},n)}))})]}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(F.a,{fullWidth:!0,children:Object(B.jsx)(Tt.a,{value:w,onChange:function(e){k(Number(e.target.value))},label:"Port",variant:"outlined"})}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(F.a,{fullWidth:!0,children:Object(B.jsx)(Tt.a,{value:D,onChange:function(e){H(e.target.value)},label:"Backend",variant:"outlined"})}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(F.a,{fullWidth:!0,children:Object(B.jsx)(Tt.a,{value:L,onChange:function(e){q(e.target.value)},label:"Server",variant:"outlined"})}),Object(B.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(B.jsxs)("div",{children:["HAproxy",Object(B.jsx)(Et.a,{checked:V,onChange:function(e){U(e.target.checked)}})]})}),Object(B.jsx)(At.a,{fullWidth:!0,style:{display:"flex",justifyContent:"center"},variant:"outlined",onClick:function(){Z({variables:{backend:D,chain:i,haProxy:V,host:j,port:w,server:L,loadBalancers:g,url:"http://".concat(x,":").concat(w)}})},children:"Submit"})]})})})}function Kt(e){var t=e.selectedNode,n=e.setSelectedNode,r=t.id,c=t.backend,i=t.port,o=t.server,s=t.url,l=t.muted,j=Object(a.useState)(!1),u=Object(O.a)(j,2),b=u[0],h=u[1],x=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return ct.a(St,t)}(),f=Object(O.a)(x,2),m=f[0],p=f[1],g=p.data,v=p.error,y=p.loading,C=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(dt,t)}({onCompleted:function(){setTimeout((function(){m(),h(!1)}),1e4)},onError:function(e){return h(!1)}}),w=Object(O.a)(C,1)[0],k=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(jt,t)}({onCompleted:function(){return m()}}),P=Object(O.a)(k,1)[0],$=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(ut,t)}({onCompleted:function(){return m()}}),D=Object(O.a)($,1)[0],H=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(bt,t)}({onCompleted:function(e){var a=e.muteMonitor.muted;n(Object(d.a)(Object(d.a)({},t),{},{muted:a}))}}),N=Object(O.a)(H,1)[0],I=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return at.a(Ot,t)}({onCompleted:function(e){var a=e.unmuteMonitor.muted;n(Object(d.a)(Object(d.a)({},t),{},{muted:a}))}}),L=Object(O.a)(I,1)[0];Object(a.useEffect)((function(){var e=t.id;m({variables:{id:e}})}),[m,t]);if(y)return Object(B.jsx)(B.Fragment,{children:"Loading..."});if(v)return Object(B.jsxs)(B.Fragment,{children:[" Error! $",v.message]});if(g){var M=g.haProxyStatus,T={"-1":"No HAProxy",0:"OK",1:"Offline"}[M],E=l?"Muted":"Not Muted";return Object(B.jsx)(B.Fragment,{children:Object(B.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"space-between",alignItems:"center"},children:Object(B.jsxs)(J.a,{style:{width:434,padding:10},variant:"outlined",children:[Object(B.jsx)(S.a,{align:"center",variant:"h6",gutterBottom:!0,children:"Selected Node"}),Object(B.jsxs)(J.a,{style:{padding:10},variant:"outlined",children:[Object(B.jsxs)(S.a,{children:["Backend: ",c]}),Object(B.jsxs)(S.a,{children:["Port: ",i||"None"]}),Object(B.jsxs)(S.a,{children:["Server: ",o||"None"]}),Object(B.jsx)(S.a,{children:s})]}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(J.a,{style:{padding:10},variant:"outlined",children:b?Object(B.jsx)(S.a,{variant:"h4",children:"Rebooting..."}):Object(B.jsxs)(B.Fragment,{children:[Object(B.jsxs)(S.a,{variant:"h6",children:["HAProxy Status: ",T]}),Object(B.jsxs)(S.a,{variant:"h6",children:["Mute Status: ",E]})]})}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(J.a,{style:{display:"flex",flexDirection:"column",width:"100%",padding:10},variant:"outlined",children:Object(B.jsxs)(F.a,{fullWidth:!0,children:[Object(B.jsx)(At.a,{fullWidth:!0,style:{display:"flex",justifyContent:"center"},variant:"outlined",onClick:function(){return function(e){b||(h(!0),w({variables:{id:e}}))}(r)},disabled:0!==M,children:b?Object(B.jsxs)(B.Fragment,{children:[Object(B.jsx)(X.a,{size:20,sx:{marginRight:"8px"}}),"Rebooting Server..."]}):"Reboot Server"}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(At.a,{fullWidth:!0,style:{display:"flex",justifyContent:"center"},variant:"outlined",onClick:function(){return function(e,t){return 0===t?D({variables:{id:e}}):P({variables:{id:e}})}(r,M)},disabled:-1===M,children:{"-1":"No HAProxy",0:"Disable HAProxy",1:"Enable HAProxy"}[M]}),Object(B.jsx)("div",{style:{marginTop:"10px"}}),Object(B.jsx)(At.a,{fullWidth:!0,style:{display:"flex",justifyContent:"center"},variant:"outlined",onClick:function(){return function(e){return l?L({variables:{id:e}}):N({variables:{id:e}})}(r)},children:l?"Unmute Monitor":"Mute Monitor"})]})})]})})})}return Object(B.jsx)(B.Fragment,{})}function Qt(){var e,t=Object(a.useState)(void 0),n=Object(O.a)(t,2),r=n[0],c=n[1],i=pt(),o=i.data,s=i.error,l=i.loading,j=i.refetch,u=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(Ct,t)}(),b=u.data,h=u.error,x=u.loading;return!l&&!x||r?s||h?Object(B.jsxs)(B.Fragment,{children:["Error! $",null===(e=s||h)||void 0===e?void 0:e.message]}):o&&b?Object(B.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"16px"},children:[Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",width:"60%",marginBottom:"16px"},children:[Object(B.jsx)(Zt,{formData:b,refetchNodes:j}),r&&Object(B.jsx)(Kt,{selectedNode:r,setSelectedNode:c}),Object(B.jsx)(Jt,{formData:b,refetchNodes:j})]}),Object(B.jsx)(pe,{type:"Nodes",paginate:!0,searchable:!0,rows:o.nodes,selectedRow:null===r||void 0===r?void 0:r.id,onSelectRow:c})]}):Object(B.jsx)(B.Fragment,{}):Object(B.jsx)(B.Fragment,{children:"Loading..."})}function Xt(){var e=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(vt,t)}(),t=e.data,n=e.error;return e.loading?Object(B.jsx)(B.Fragment,{children:"Loading..."}):n?Object(B.jsxs)(B.Fragment,{children:["Error! $",n.message]}):Object(B.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"16px"},children:t&&Object(B.jsx)(pe,{type:"Oracles",searchable:!0,rows:t.oracles})})}function Yt(){var e=function(e){var t=Object(d.a)(Object(d.a)({},it),e);return rt.a(yt,t)}(),t=e.data,n=e.error;return e.loading?Object(B.jsx)(B.Fragment,{children:"Loading..."}):n?Object(B.jsxs)(B.Fragment,{children:["Error! $",n.message]}):Object(B.jsx)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",margin:"16px"},children:t&&Object(B.jsx)(pe,{type:"Webhooks",searchable:!0,paginate:!0,rows:t.webhooks})})}var en=Object(x.a)(y.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return Object(d.a)({zIndex:t.zIndex.drawer+1,transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})},n&&{marginLeft:240,width:"calc(100% - ".concat(240,"px)"),transition:t.transitions.create(["width","margin"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen})})})),tn=Object(x.a)(g.a,{shouldForwardProp:function(e){return"open"!==e}})((function(e){var t=e.theme,n=e.open;return{"& .MuiDrawer-paper":Object(d.a)({position:"relative",whiteSpace:"nowrap",width:240,transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.enteringScreen}),boxSizing:"border-box"},!n&&Object(h.a)({overflowX:"hidden",transition:t.transitions.create("width",{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen}),width:t.spacing(7)},t.breakpoints.up("sm"),{width:t.spacing(9)}))}})),nn=Object(f.a)();function an(){var e=a.useState(!0),t=Object(O.a)(e,2),n=t[0],r=t[1],c=function(){r(!n)};return Object(B.jsx)(m.a,{theme:nn,children:Object(B.jsxs)(v.a,{sx:{display:"flex"},children:[Object(B.jsx)(p.a,{}),Object(B.jsx)(en,{position:"absolute",open:n,children:Object(B.jsxs)(C.a,{sx:{pr:"24px"},children:[Object(B.jsx)(w.a,{edge:"start",color:"inherit","aria-label":"open drawer",onClick:c,sx:Object(d.a)({marginRight:"36px"},n&&{display:"none"}),children:Object(B.jsx)($.a,{})}),Object(B.jsx)(S.a,{flex:"1",align:"center",component:"h1",variant:"h6",color:"black",noWrap:!0,sx:{flexGrow:1},children:"Pocket Node Nanny"})]})}),Object(B.jsxs)(tn,{variant:"permanent",open:n,children:[Object(B.jsx)(C.a,{sx:{display:"flex",alignItems:"center",justifyContent:"flex-end",px:[1]},children:Object(B.jsx)(w.a,{onClick:c,children:Object(B.jsx)(H.a,{})})}),Object(B.jsx)(et,{})]}),Object(B.jsxs)(v.a,{component:"main",sx:{backgroundColor:function(e){return"light"===e.palette.mode?e.palette.grey[100]:e.palette.grey[900]},flexGrow:1,height:"100vh",overflow:"auto"},children:[Object(B.jsx)(k.a,{maxWidth:"lg",sx:{mt:4,mb:4},children:Object(B.jsx)("div",{children:"___"})}),Object(B.jsx)(N.a,{exact:!0,path:"/",component:I}),Object(B.jsx)(N.a,{exact:!0,path:"/logs",component:Ft}),Object(B.jsx)(N.a,{exact:!0,path:"/nodes",component:Qt}),Object(B.jsx)(N.a,{exact:!0,path:"/hosts",component:Wt}),Object(B.jsx)(N.a,{exact:!0,path:"/chains",component:Mt}),Object(B.jsx)(N.a,{exact:!0,path:"/oracles",component:Xt}),Object(B.jsx)(N.a,{exact:!0,path:"/webhooks",component:Yt}),Object(B.jsx)(N.a,{exact:!0,path:"/settings",component:L})]})]})})}function rn(){return Object(B.jsx)(an,{})}i.a.render(Object(B.jsx)(r.a.StrictMode,{children:Object(B.jsx)(s.a,{client:b,children:Object(B.jsx)(o.a,{children:Object(B.jsx)(rn,{})})})}),document.getElementById("root"))}},[[202,1,2]]]);
//# sourceMappingURL=main.47581c93.chunk.js.map